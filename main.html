<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <script src="script.js"></script>
</head>

<body>
    <div class="container">
        <main>
            <div class="sidebar" style="padding: 20px ;
                                        width: 80px;
                                        height: calc(100vh - 200px);
                                        top: 20px;
                                        left: 20px;">
                <div class="sidebar-content">
                    <header>
                        <img src="images/icon_removed_bg.png" alt="icon" id="header-icon" class="scrollable" style="width: 80px; height: 90px; overflow: scroll;">
                        <a href="#" class="button" id="header-icon" alt="icon"></a>
                    </header>
                    <hr>
                    <ul class="scrollable" style="height: calc(100vh - 290px); overflow: scroll;">
                            <button type="button" class="choosing_album" style="padding: 3px 0px;"><img id="" src="images/EDM_cover.jpeg"
                                    style="width: 70px; border-radius: 20px; border: #00ffaa solid 2px; text-align: center;"><br>EDM</button>
                            <button type="button" class="choosing_album" style="padding: 3px 0px;"><img id="" src="images/JAZZ_cover.png"
                                    style="width: 70px; border-radius: 20px; border: #00ffaa solid 2px; text-align: center;"><br>JAZZ</button>
                            <button type="button" class="choosing_album" style="padding: 3px 0px;"><img id="" src="images/LOFI_cover.jpg"
                                    style="width: 70px; border-radius: 20px; border: #00ffaa solid 2px; text-align: center;"><br>LOFI</button>
                            <button type="button" class="choosing_album" style="padding: 3px 0px;"><img id="" src="images/EDM_cover.jpeg"
                                    style="width: 70px; border-radius: 20px; border: #00ffaa solid 2px; text-align: center;"><br>PHONK</button>
                            <button type="button" class="choosing_album" style="padding: 3px 0px;"><img id="" src="images/EDM_cover.jpeg"
                                    style="width: 70px; border-radius: 20px; border: #00ffaa solid 2px; text-align: center;"><br>POP</button>
                            <button type="button" class="choosing_album" style="padding: 3px 0px;"><img id="" src="images/EDM_cover.jpeg"
                                    style="width: 70px; border-radius: 20px; border: #00ffaa solid 2px; text-align: center;"><br>ROCK</button>
                        <section id="playlist-section">
                            <div class="playlist"></div>
                    </ul>
                    </section>
                </div>
            </div>

            <div class="sidebar main-content-sidebar" style="padding: 20px ;
                                        width: calc(100vw - 235px);
                                        height: calc(100vh - 200px);
                                        top: 20px;
                                        left: 165px;">
                <div class="sidebar-content scrollable" style="height: calc(100vh - 170px); overflow: scroll;">
                    <audio id="audio-source" controls >
                        <source src="./music/rock/二口魔菜 Futakuchi Mana - KING - 01 KING.mp3" type="audio/mp3">
                        Your browser does not support the audio element.
                    </audio>
                    <section id="playlist-section">
                        <div class="main-content">
                            <div class="section-active" id="file" style="padding: 10px;">
                                <div class="song-info-main">
                                    <img src="images/EDM_cover.jpeg" alt="Album Art" class="album-art-main">
                                    <div class="header-content" style="text-align: top;">Album's name</div>
                                    <div class="song-details">
                                        <div class="song-title-main"></div>
                                        <div class="artist-main"></div>
                                    </div>
                                </div>
                                <div class="song-list-cotainer">
                                    <div class="song-list-contai">
                                        <span class="song-number-header">#</span>
                                        <span class="song-name-header">Name</span>
                                        <span class="song-duration-header">Time</span>
                                    </div>
                                    <div class="song-list">
                                    </div>
                                </div>
                            </div>
                    </section>
                </div>
            </div>
            <div class="sidebar player-controls-sidebar" style="padding: 20px ;
                                                                width: calc(100vw - 88px);
                                                                height: 50px;
                                                                top: calc(100vh - 117px);
                                                                left: 20px;">
                <div class="sidebar-content">
                    <div class="player">
                        <div class="progress-bar">
                            <div class="progress"></div>
                        </div>
                        <div class="player-control">
                            <button class="prev"><i class="fas fa-step-backward"></i></button>
                            <button class="play-pause"><i class="fas fa-play"></i></button>
                            <button class="next"><i class="fas fa-step-forward"></i></button>
                            <div class="time-info">
                                <span class="current-time">00:00</span>
                                <span>/</span>
                                <span class="total-time">00:00</span>
                            </div>
                            <button class="repeat"><i class="fas fa-redo"></i></button>
                            <button class="shuffle"><i class="fas fa-random"></i></button>
                            <div class="volume-control">
                                <i class="fas fa-volume-up"></i>
                                <input type="range" class="volume bar" min="0" max="1" step="0" value="0.5">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        <audio id="audio-element"></audio>

        <div id="audio-container">
            <canvas id="audio-visualizer"></canvas>
        </div>
        <script>
            const audio = document.getElementById('audio-source');
            const canvas = document.getElementById('audio-visualizer');
            const ctx = canvas.getContext('2d');
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const analyser = audioContext.createAnalyser();
            const source = audioContext.createMediaElementSource(audio);
    
            source.connect(analyser);
            analyser.connect(audioContext.destination);
    
            analyser.fftSize = 256;
            const bufferLength = analyser.frequencyBinCount;
            const dataArray = new Uint8Array(bufferLength);
    
            function draw() {
                requestAnimationFrame(draw);
    
                analyser.getByteFrequencyData(dataArray);
    
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
    
                ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear the canvas
    
                const barWidth = (canvas.width / bufferLength) * 2.5;
                let barHeight;
                let x = 0;
    
                for (let i = 0; i < bufferLength; i++) {
                    barHeight = dataArray[i];
    
                    ctx.fillStyle = '#00ffaa'; // Use the specified color
                    ctx.fillRect(x, canvas.height - barHeight / 1, barWidth, barHeight / 1);
    
                    x += barWidth + 1;
                }
            }
    
            audio.play();
            draw();
        </script>
        
</body>

</html>